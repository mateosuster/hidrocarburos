---
title: "Series económicas del sector hidrocarburífero argentino"
author:
- affiliation: UNGS/CONICET
  name: Mateo Suster y Juan Kornblihtt
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r include=FALSE}
# bibliotecas
library(data.table)
library(tidyverse)
library(knitr)
library(kableExtra)
library(ggplot2)
library(plotly)
```


```{r}
# datos
data = fread("../resultados/argentina/variables.csv")
variables = unique(data$variable)

glimpse(data)

```


## Producción

Fuentes: 

* [Ministerio de Hacienda, Informes
Sectoriales](https://www.argentina.gob.ar/economia/politicaeconomica/regionalysectorial/informesproductivos) (1998-hoy). 
* [Secretaría de Energía - Regalias](http://datos.minem.gob.ar/dataset/regalias-de-petroleo-crudo-gas-natural-glp-gasolina-y-condensado) (1998-hoy)
* [Secretaría de Energía - SESCO Downstream](http://datos.minem.gob.ar/dataset/produccion-de-petroleo-y-gas-tablas-dinamicas)(1993-hoy)
* [Anuario de combustibles](http://datos.minem.gob.ar/dataset/anuarios-de-combustibles-1950-1999) (1911-1992)
* Kozulj y Pistonesi. Revista  del Instituto de Economía Energética (IDEE) - Fundación Bariloche  (1970 - 1988)
* [EIA](https://www.eia.gov/international/data/country/ARG/petroleum-and-other-liquids/annual-petroleum-and-other-liquids-production?pd=5&p=0000000000000000000000000000000000vg&u=0&f=A&v=mapbubble&a=-&i=none&vo=value&&t=C&g=none&l=249--6&s=94694400000&e=1546300800000) (1980 - 2019)

### Producción de Crudo


La producción de petróleo crudo de largo plazo proviene del Anuario de Combustibles, de la cual contamos datos desde 1911 hasta 1992. Sus valores para el período 1980-1992 coinciden con los de EIA, por lo cual pueden usarse como fuentes alternativas. Asimismo, la evolución de SESCO es similar a la de EIA, salvo por pequeñas divergencias entre 2008 y 2013. La serie de Regalías presenta un nivel menor que las anteriores debido a las deducciones de producción que realizan las empresas para pagar un menor nivel de Regalías hacia las provincias donde realizan la producción. Por último, la serie del Ministerio de Economía coincide con Regalías en sus primeros años, luego presenta un nivel intermedio entre Regalías y SESCO y a partir de 2009 toma a SESCO como fuente. Salvo el Anuario de Combustibles, el resto de las series presentan datos hasta los últimos años. Por lo tanto, el criterio de selección para la serie de producción con la que se realizarán los cálculos es el siguiente:

* Criterio de cómputo para producicón de crudo: 
  + 1911 a 1992: Anuario de combustibles 
  + 1993 - actualidad: SESCO Downstream
  
  
```{r}
prod_crudo_plt <-  ggplot(data[ variable == "Producción de petróleo crudo", ],
                          aes(anio, valor, color = fuente))+
  geom_line()+
  labs(title = "Gráfico 1. Producción de petróleo crudo. Argentina (1911 - 2020)",
       y = "Millones de Barriles",
       x = "Año",
       caption = "Fuente: elaboración propia en base a Anuario de Combustibles, EIA, Ministerio de Economía, Secretaría de Energía (Base Regalías y SESCO)")+
  theme(legend.position = "bottom", plot.caption = element_text(size = 7.5))+
  # scale_shape_discrete(name = "Fuente")+
  # scale_y_continuous(labels=function(x) format(x, big.mark = ".", scientific = FALSE))+
  scale_y_continuous(labels = scales::unit_format(unit ="", scale = 1e-6))+
  scale_x_continuous(breaks = seq(1910, 2030, by = 10))
prod_crudo_plt

ggplotly(prod_crudo_plt) %>%
  layout(legend = list(
      orientation = "h",
         x = 0.1, y = -0.2) )

```
```{r}
as.data.frame(dcast(data[ variable == "Producción de petróleo crudo", ] , 
      anio ~ fuente, value.var = "valor"))  %>%
  kable(caption = "Tabla 1. Producción de petróleo crudo en Argentina según distintas fuentes (barriles)",
        knitr.kable.NA = "", booktabs = TRUE)  %>%
  # kable_styling(bootstrap_options = c("striped"))
  kable_styling(latex_options = "repeat_header", repeat_header_text = "Table 2 cont.")

# library(htmlTable)
# htmlTable(dcast(data[ variable == "Producción de petróleo crudo", ] , 
#       anio ~ fuente, value.var = "valor"),
#           # cgroup = c("Set 1:25", "Set 26:50"),
#           # n.cgroup = c(2, 2),
#           # rnames = FALSE
#       )
```

### Producción de Gas Natural

Al igual que en la producción de petróleo crudo, la serie de largo plazo de producción de gas proviene del Anuario de Combustibles, de la cual contamos datos desde 1913 hasta 1992. A diferencia del crudo, sus valores para el período 1980-1992 no coinciden con los de EIA, pero está última sí coincide con los de Regalías entre 1999 y 2015. En cambio, la serie de SESCO, tiende a continuar la evolución de EIA y Regalías, pero con el nivel del Anuario de Combustibles, por lo que ambos pares de series pueden empalmar coherentemente según su nivel. Nuevamente, los valores de la base de Regalías son menores debido a las deducciones de producción para tributar menos regalías. La serie del Ministerio de Economía toma los valores de SESCO.Por lo tanto, el criterio de selección para la serie de producción de gas para los cálculos es el siguiente:

* Criterio de cómputo de la producción de gas:
  + 1911 a 1992: Anuario de combustibles 
  + 1993 en adelante: SESCO Downstream
  
  
```{r}

prod_gas_plt <-  ggplot(data[ variable == "Producción de gas natural", ],
                          aes(anio, valor, color = fuente))+
  geom_line()+
  labs(title = "Gráfico 2. Producción de gas. Argentina (1913 - 2020)",
       y = "MMBTU", x = "Año",
       caption = "Fuente: elaboración propia en base a Anuario de Combustibles, EIA, Ministerio de Economía, Secretaría de Energía (Base Regalías y SESCO)")+
  scale_y_continuous(labels=function(x) format(x, big.mark = ".", scientific = FALSE))+
  scale_x_continuous(breaks = seq(1910, 2030, by = 10))+
  theme(legend.position = "bottom", plot.caption = element_text(size = 7.5) )
# prod_gas_plt


ggplotly(prod_gas_plt) %>%
  layout(legend = list(
      orientation = "h",
         x = 0.1, y = -0.2) )
```
```{r}
as.data.frame(dcast(data[ variable == "Producción de gas natural", ] , 
      anio ~ fuente, value.var = "valor"))  %>%
  kable(caption = "abla 2. Producción de gas natural en Argentina según distintas fuentes (MMBTU)",
        knitr.kable.NA = "", booktabs = TRUE)  %>%
  # kable_styling(bootstrap_options = c("striped"))
  kable_styling(latex_options = "repeat_header", repeat_header_text = "Table 2 cont.")
```

## Precio Mercado Interno

  Fuentes: 

* [Base Ministerio de Hacienda, Informes
Sectoriales](https://www.argentina.gob.ar/economia/politicaeconomica/regionalysectorial/informesproductivos)
* [Secretaría de Energía-Regalias](http://datos.minem.gob.ar/dataset/regalias-de-petroleo-crudo-gas-natural-glp-gasolina-y-condensado)
  + Por ausencia de información, el precio de regalias entre 1993 y 1998 es el precio total (es decir, es un ponderado que incluye también el precio del mercado externo). En los años posteriores, dicho precio sí corresponde al del mercado interno.  
* Kozulj y Pistonesi. Revista  del Instituto de Economía Energética (IDEE) - Fundación Bariloche  (1970 - 1988). Precio oficial interno de la cuenca neuquina a tasa de cambio oficial. Las fuentes utilizadas de esta revista son Secretaria de Energía, YPF, Gas del Estado, Boletin Informativo de Techint y series propias de IDEE
* Memoria Anual y balances contables de YPF (varios años). Precio intero promedio resultante de la relación entre ventas y cantidades producidas.


####  Precio Mercado Interno de Crudo

* Criterio para precio_crudo: 
  + 1963 a 1965: Kozulj y Pistonesi - Revista IDEE ajustado con el índice del precio del Anuario de YPF 
  + 1989 a 1991: Anuario de YPF
  + 1966 a 1988: Kozulj y Pistonesi - Revista IDEE
  + 1992: MECON ajustado con la variación del Índice de precios internos al por mayor (IPIM)
  + 1993 en adelante: MECON 
 
```{r}

precio_crudo_plt <-  ggplot(data[ variable == variables[5], ],
                          aes(anio, valor, color = fuente))+
  geom_line(alpha = 0.8)+
  labs(title = "Gráfico 3. Precios del mercado interno del petróleo crudo. Argentina (1963 - 2020)",
       y = "USD/barril", x = "Año",
       caption = "Fuente: elaboración propia en base a IDEE, Ministerio de Economía, Secretaría de Energía (Base Regalías) y Balances Contables de YPF")+
  # scale_y_continuous(labels=function(x) format(x, big.mark = ".", scientific = FALSE))+
  scale_x_continuous(breaks = seq(1910, 2030, by = 10))+
  theme(legend.position = "bottom", plot.caption = element_text(size = 7.5) )


ggplotly(precio_crudo_plt)  %>%
  layout(legend = list(
      orientation = "h",
         x = 0.1, y = -0.2) )

```

**Tabla 3. Precio del mercado interno del petróleo crudo en Argentina según distintas fuentes (barriles)**
```{r echo=FALSE, message=FALSE, warning=FALSE}

```


#### Precio Mercado Interno de Gas Natural
* Precio Mercado Interno de gas:
  + 1963 - 1969 & 1989 - 1992: Anuario de YPF
  + 1970 - 1988:  Kozulj y Pistonesi - Revista IDEE
  + 1993 en adelante: Secretaría de Energía - Base Regalías
  + Años faltantes: [...]
  

```{r}
precio_gas_plt <-  ggplot(data[ variable == variables[6], ],
                          aes(anio, valor, color = fuente))+
  geom_line(alpha = 0.8)+
  labs(title = "Gráfico 4. Precios del mercado interno del gas natural. Argentina (1963 - 2020)",
       y = "USD/MMBTU", x = "Año",
       caption = "Fuente: elaboración propia en base a IDEE, Ministerio de Economía, Secretaría de Energía (Base Regalías) y Balances Contables de YPF")+
  # scale_y_continuous(labels=function(x) format(x, big.mark = ".", scientific = FALSE))+
  scale_x_continuous(breaks = seq(1910, 2030, by = 10))+
  theme(legend.position = "bottom", plot.caption = element_text(size = 7.5) )

ggplotly(precio_gas_plt)  %>%
  layout(legend = list(
      orientation = "h",
         x = 0.1, y = -0.2) )
```

<br>
**Tabla 4. Precio del mercado interno del gas natural en Argentina según distintas fuentes (MMBTU)**
```{r}

```


## Precios de Referencia del Mercado Mundial
Precios de exportación desde Argentina, benchmarks y Precios del mercado de EEUU (solo gas, internos y de expo/impo)

* [Secretaría de Energía-Regalias](http://datos.minem.gob.ar/dataset/regalias-de-petroleo-crudo-gas-natural-glp-gasolina-y-condensado)) (2006-hoy)
* [MECON](http://datos.minem.gob.ar/dataset/precio-de-exportacion-de-petroleo-crudo). Serie corta y sin transformaciones
* EIA
  + [Brent](https://www.eia.gov/dnav/pet/hist/RBRTED.htm) (1987-hoy)
  + [WTI](https://www.eia.gov/dnav/pet/hist/rwtcD.htm) (1986-hoy)
  + [Henry Hub](https://www.eia.gov/dnav/ng/hist/rngwhhdd.htm) (1997-hoy)
  + [Precio Gas de Boca de Pozo en EEUU](https://www.eia.gov/dnav/ng/hist/n9190us3A.htm)
* [Inflation Data](https://inflationdata.com/articles/inflation-adjusted-prices/historical-crude-oil-prices-table/) (1946-hoy)
* [Eurostat](https://ec.europa.eu/eurostat/web/energy/data/database)
* Revista IDEE   
  + Precio de Importación de gas natural desde Bolivia (1970-1988)
* [UN Comtrade](https://comtrade.un.org/data/)
  + Precio de Exportación e Importación de gas y crudo (a Bolivia y promedio mundial)
  + El precio impo bolivia de  UN Comtrade cierra, da valores coherentes pero no deberia, dado que la conversión deberia realizarse multiplicando el precio en Mm3 por 1000 y ahí recién realizar la conversión
  

#### Precios de Referencia del Crudo
* Fuentes seleccionadas para precio_me_crudo: 
  + entre 1962 y 1992: precio de exportación argentina de UN Comtrade (clasificación SITC as reported)
  + entre 1993-2001 y 2004-2014: precio de exportación argentina de Mecon
  + entre 2002 y 2003: precio de exportación de Argentina de UN Comtrade (Clasificación HS as reported)
  + 2014 en adelante: precio de exportación argentina de Secretaría de Energía (Regalías)
  + Valores faltantes previos a 1992 (1970 - 1985): Brent (Fuente: Inflation Data)

```{r}
precio_ref_crudo_plt <-  ggplot(data[ variable == variables[7], ],
                          aes(anio, valor, color = fuente))+
  geom_line(alpha = 0.8)+
  labs(title = "Gráfico 4. Precios de referencia del mercado mundial del crudo (1946 - 2020)",
       y = "USD/MMBTU", x = "Año",
       caption = "Fuente: elaboración propia en base a EIA e Inflation Data")+
  # scale_y_continuous(labels=function(x) format(x, big.mark = ".", scientific = FALSE))+
  scale_x_continuous(breaks = seq(1910, 2030, by = 10))+
  theme(legend.position = "bottom", plot.caption = element_text(size = 7.5) )

ggplotly(precio_ref_crudo_plt)  %>%
  layout(legend = list(
      orientation = "h",
         x = 0.1, y = -0.2) )

```
##### Precio de Exportación del Crudo

```{r}
precio_expo_crudo_plt <-  ggplot(data[ variable == variables[8], ],
                          aes(anio, valor, color = fuente))+
  geom_line(alpha = 0.8)+
  labs(title = "Gráfico #. Precios de exportacion de crudo. Argentina (1964 - 2020)",
       y = "USD/barril", x = "Año",
       caption = "Fuente: elaboración propia en base a Sec. Energía, MECON, UN-Comtrade...")+
  # scale_y_continuous(labels=function(x) format(x, big.mark = ".", scientific = FALSE))+
  scale_x_continuous(breaks = seq(1910, 2030, by = 10))+
  theme(legend.position = "bottom", plot.caption = element_text(size = 7.5) )

ggplotly(precio_expo_crudo_plt)  %>%
  layout(legend = list(
      orientation = "h",
         x = 0.1, y = -0.2) )
```

  
##### Diferencial de precios  
```{r}
# visualizacion diferencial de precio mdo interno
# ggsave("../resultados/argentina/precio_interno_vs_externo.jpg")

brecha_precio_crudo_plt <-  ggplot(data[ variable %in% variables[c(5,7)], ],
                          aes(anio, valor, color = fuente))+
  geom_line(alpha = 0.8)+
  labs(title = "Gráfico #. Precio de venta al mercado interno, exportacion y referencias del petróleo crudo (1960 - 2020)",
       y = "USD/barril", x = "Año",
       caption = "Fuente: elaboración propia en base a EIA, Sec. de Energía y MECON")+
  # scale_y_continuous(labels=function(x) format(x, big.mark = ".", scientific = FALSE))+
  scale_x_continuous(breaks = seq(1910, 2030, by = 10))+
  theme(legend.position = "bottom", plot.caption = element_text(size = 7.5) )

ggplotly(brecha_precio_crudo_plt)  %>%
  layout(legend = list(
      orientation = "h",
         x = 0.1, y = -0.2) )

```

#### Precios de Referencia del Gas

* Criterio de precio_externo_gas:
  + Años 1964 y 1965: Precio de importación de gas proveniente de Bolivia hacia Argentina de UN Comtrade
  + 1966 en adelante: Precio de exportacion de gas desde Bolivia a Argentina de UN Comtrade
  + Datos faltantes para los años previos a 1963 y período 1968-1971
  
```{r}
precio_ref_gas_plt <-  ggplot(data[ (variable %in% variables[9:25])&
                                           (!str_detect(variable, "GNL|LNG|OCDE|importación|exportación") ), ],
                          aes(anio, valor, color = variable))+
  geom_line(alpha = 0.8)+
  labs(title = "Gráfico #. Precios de referencia del gas natural de EEUU y Europa (1960 - 2020)",
       y = "USD/MMBTU", x = "Año",
       caption = "Fuente: elaboración propia en base a EIA y BP")+
  # scale_y_continuous(labels=function(x) format(x, big.mark = ".", scientific = FALSE))+
  scale_x_continuous(breaks = seq(1910, 2030, by = 10))+
  theme(legend.position = "bottom", plot.caption = element_text(size = 7.5) )

ggplotly(precio_ref_gas_plt)  %>%
  layout(legend = list(
      orientation = "h",
         x = 0.1, y = -0.2) )


```


```{r}
precio_ref_gas_plt_2 <-  ggplot(data[ (variable %in% variables[9:25])&
                                           (!str_detect(variable, "GNL|LNG|OCDE") )&
                                      (str_detect(variable, "importación|exportación") ), ],
                          aes(anio, valor, color = variable))+
  geom_line(alpha = 0.8)+
  labs(title = "Gráfico #. Precios de exportación e importación del gas natural de EEUU y Europa (1984 - 2020)",
       y = "USD/MMBTU", x = "Año",
       caption = "Fuente: elaboración propia en base a EIA y BP")+
  # scale_y_continuous(labels=function(x) format(x, big.mark = ".", scientific = FALSE))+
  scale_x_continuous(breaks = seq(1910, 2030, by = 10))+
  theme(legend.position = "bottom", plot.caption = element_text(size = 7.5) )

ggplotly(precio_ref_gas_plt_2)  %>%
  layout(legend = list(
      orientation = "h",
         x = 0.1, y = -0.2) )

```

##### Precio de Exportación del Gas Natural
```{r}
precio_expo_gas_plt <-  ggplot(data[ (variable %in% variables[31]) , ],
                          aes(anio, valor, color = fuente))+
  geom_line(alpha = 0.8)+
  labs(title = "Gráfico #. Precios de exportación del gas natural. Argentina (1962 - 2020)",
       y = "USD/MMBTU", x = "Año",
       caption = "Fuente: elaboración propia en base a Sec. de Energía, MECON, IDEE y UN-Comtrade")+
  # scale_y_continuous(labels=function(x) format(x, big.mark = ".", scientific = FALSE))+
  scale_x_continuous(breaks = seq(1910, 2030, by = 10))+
  theme(legend.position = "bottom", plot.caption = element_text(size = 7.5) )

ggplotly(precio_expo_gas_plt)  %>%
  layout(legend = list(
      orientation = "h",
         x = 0.1, y = -0.2) )

```

##### Precio de Importación del Gas Natural
```{r}
precio_impo_gas_plt <-  ggplot(data[ (variable %in% variables[26:30]) , ],
                          aes(anio, valor, color = variable))+#, group =codigo_variable))+
  geom_line(alpha = 0.8 , aes(linetype = fuente))+
  labs(title = "Gráfico #. Precios de importación del gas natural. Argentina (1962 - 2020)",
       y = "USD/MMBTU", x = "Año",
       caption = "Fuente: elaboración propia en base a Sec. de Energía, MECON, IDEE y UN-Comtrade")+
  # scale_y_continuous(labels=function(x) format(x, big.mark = ".", scientific = FALSE))+
  scale_x_continuous(breaks = seq(1910, 2030, by = 10))+
  theme(legend.position = "bottom", plot.caption = element_text(size = 7.5) )

ggplotly(precio_impo_gas_plt)  %>%
  layout(legend = list(
      orientation = "h",
         x = 0.1, y = -0.2) )

```



